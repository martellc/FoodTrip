package com.foodtrip.ftcontroller;

import javax.ejb.Stateless;

import org.apache.log4j.Logger;
import org.neo4j.graphdb.GraphDatabaseService;

import com.foodtrip.ftmodeldb.Neo4JConnector;
import com.foodtrip.ftmodeldb.model.Company;
import com.foodtrip.ftmodeldb.model.Farm;
import com.foodtrip.ftmodeldb.model.Order;
import com.foodtrip.ftmodeldb.model.OrderProductRel;
import com.foodtrip.ftmodeldb.model.Product;
import com.foodtrip.ftmodeldb.repo.OrderRepository;

@Stateless
public class FTOperationController {
	public static Neo4JConnector connector;
	private static final Logger logger = Logger.getLogger(FTOperationController.class);

	public Order startTrip(Product p, Farm farm) {
		Order order = new Order();
		order.setFarm(farm);
		OrderProductRel op = new OrderProductRel(order,p);
		order.setOrderProductRel(op);

		GraphDatabaseService graph = connector.graphDatabaseService();
		OrderRepository orderRepository = connector.getOrderRepository();
		graph.beginTx();
		try {
			order = orderRepository.save(order);
			return order;
		} catch(Exception e) {
			logger.error("Error:",e);
		}

		return null;
	}
	
	
	public void addStep(Long orderID, Company company) {
		
		if (orderID == null) {
			logger.error("orderNullError");
			return;
		}
		
		
	}
}